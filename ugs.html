<!DOCTYPE html>
<html>
<head>
<audio src="https://cdn.jsdelivr.net/gh/shayderrr/Static@main/Ambient-BreakcoreDnB-Mix-02.mp3" autoplay loop></audio>
    <title>UGS Files</title>
    <style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: #000000;
    min-height: 100vh;
    color: #e5e7eb;
    position: relative;
    overflow-x: hidden;
}

/* Animated background */
.background-gradient {
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: linear-gradient(135deg, #000000 0%, #0a0015 50%, #000000 100%);
    z-index: 0;
}

.stars {
    position: fixed;
    width: 100%;
    height: 100%;
    background-image: 
        radial-gradient(2px 2px at 20px 30px, white, transparent),
        radial-gradient(2px 2px at 60px 70px, white, transparent),
        radial-gradient(1px 1px at 50px 50px, white, transparent),
        radial-gradient(1px 1px at 130px 80px, white, transparent),
        radial-gradient(2px 2px at 90px 150px, white, transparent);
    background-repeat: repeat;
    background-size: 200px 200px;
    opacity: 0.4;
    animation: starsMove 100s linear infinite;
    z-index: 1;
}

@keyframes starsMove {
    from { transform: translateY(0); }
    to { transform: translateY(-200px); }
}

/* Purple glow orbs */
.orb {
    position: fixed;
    border-radius: 50%;
    filter: blur(60px);
    opacity: 0.1;
    z-index: 2;
    animation: float 20s ease-in-out infinite;
}

.orb-1 {
    width: 400px;
    height: 400px;
    background: radial-gradient(circle, #6b21a8, transparent);
    top: -100px;
    left: -100px;
    animation-duration: 25s;
}

.orb-2 {
    width: 350px;
    height: 350px;
    background: radial-gradient(circle, #4a0080, transparent);
    bottom: -100px;
    right: -100px;
    animation-duration: 30s;
    animation-delay: -10s;
}

@keyframes float {
    0%, 100% { transform: translate(0, 0) scale(1); }
    33% { transform: translate(50px, -50px) scale(1.1); }
    66% { transform: translate(-50px, 50px) scale(0.9); }
}

::-webkit-scrollbar {
    width: 8px;
    height: 8px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: rgba(139, 92, 246, 0.3);
    border-radius: 4px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(139, 92, 246, 0.5);
}

.header {
    text-align: center;
    padding: 30px 20px;
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(20px);
    position: sticky;
    top: 0;
    z-index: 100;
    box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
    border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    position: relative;
}

h1 {
    font-size: 36px;
    font-weight: 700;
    margin-bottom: 15px;
    color: #ffffff;
    text-shadow: 0 0 20px rgba(139, 92, 246, 0.3);
    font-family: 'Space Grotesk', sans-serif;
}

.subtitle {
    color: #c4b5fd;
    margin-bottom: 20px;
    font-size: 16px;
}

.subtitle a {
    color: #a78bfa;
    text-decoration: none;
    transition: color 0.3s;
    border-bottom: 1px solid transparent;
}

.subtitle a:hover {
    color: #c4b5fd;
    border-bottom-color: #a78bfa;
}

.search-container {
    max-width: 600px;
    margin: 0 auto 20px;
    position: relative;
}

.search-box {
    width: 100%;
    padding: 15px 50px 15px 20px;
    font-size: 16px;
    background: rgba(255, 255, 255, 0.05);
    border: 2px solid rgba(139, 92, 246, 0.3);
    border-radius: 30px;
    color: #e5e7eb;
    outline: none;
    transition: all 0.3s;
}

.search-box:focus {
    border-color: #8b5cf6;
    background: rgba(255, 255, 255, 0.08);
    box-shadow: 0 0 20px rgba(139, 92, 246, 0.2);
}

.search-box::placeholder {
    color: #9ca3af;
}

.search-icon {
    position: absolute;
    right: 20px;
    top: 50%;
    transform: translateY(-50%);
    font-size: 20px;
}

.main-content {
    max-width: 1200px;
    margin: 0 auto;
    padding: 30px 20px 30px 20px;
    padding-top: 0;
    position: relative;
    z-index: 10;
}

.letter-section {
    margin-bottom: 50px;
    animation: fadeIn 0.6s ease-out;
}

@keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
}

.letter-section.hidden {
    display: none;
}

.letter-header {
    font-size: 28px;
    font-weight: 700;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 2px solid rgba(139, 92, 246, 0.3);
    color: #a78bfa;
    font-family: 'Space Grotesk', sans-serif;
}

.games-grid {
    display: grid;
    grid-template-columns: repeat(3, 1fr);
    gap: 20px;
    margin-bottom: 30px;
    justify-items: stretch;
}

.game-card {
    background: rgba(255, 255, 255, 0.03);
    backdrop-filter: blur(20px);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.3s ease;
    position: relative;
    overflow: hidden;
}

.game-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: linear-gradient(135deg, transparent, rgba(139, 92, 246, 0.1));
    opacity: 0;
    transition: opacity 0.3s;
}

.game-card:hover {
    transform: translateY(-5px);
    box-shadow: 0 10px 40px rgba(139, 92, 246, 0.3);
    border-color: #8b5cf6;
    background: rgba(255, 255, 255, 0.05);
}

.game-card:hover::before {
    opacity: 1;
}

.game-title {
    font-size: 16px;
    font-weight: 500;
    color: #f9fafb;
    text-align: center;
    position: relative;
    z-index: 1;
}

.empty-section {
    grid-column: span 3;
    text-align: center;
    color: #6b7280;
    font-style: italic;
    padding: 40px;
}

.no-results {
    text-align: center;
    padding: 60px;
    color: #9ca3af;
    font-size: 18px;
}

.loading-container {
    text-align: center;
    padding: 60px;
    color: #c4b5fd;
}

.loading {
    display: inline-block;
    width: 40px;
    height: 40px;
    border: 4px solid rgba(139, 92, 246, 0.3);
    border-radius: 50%;
    border-top-color: #8b5cf6;
    animation: spin 1s ease-in-out infinite;
    margin-bottom: 20px;
}

@keyframes spin {
    to { transform: rotate(360deg); }
}

.error-message {
    text-align: center;
    padding: 60px;
    color: #f87171;
    font-size: 18px;
}

@media (max-width: 1200px) {
    .games-grid {
        grid-template-columns: repeat(2, 1fr);
    }
}

@media (max-width: 768px) {
    .main-content {
        padding: 20px;
    }

    .games-grid {
        grid-template-columns: 1fr;
    }

    h1 {
        font-size: 28px;
    }

    .letter-header {
        font-size: 24px;
    }
}
    </style>
</head>
<body>
    <div class="header">
<h1>Unblocked HTML Files</h1>
        <div class="subtitle">
            Files from 
            <a href="https://docs.google.com/document/d/1_FmH3BlSBQI7FGgAQL59-ZPe8eCxs35wel6JUyVaG8Q/" target="_blank">
                Ultimate Game Stash.    
            </a>
            Some games may not work.
        </div>
        <div class="search-container">
            <input type="text" class="search-box" id="searchBox" placeholder="Search for games..." disabled>
            <span class="search-icon">üîç</span>
        </div>
    </div>

    <div class="main-content">
        <div id="loading" class="loading-container">
            <div class="loading"></div>
            <div>Loading games from repository...</div>
        </div>
        <div id="error" class="error-message" style="display: none;"></div>
        <div id="sections-container"></div>
        <div id="no-results" class="no-results" style="display: none;">
            No games found matching your search.
        </div>
    </div>

    <script>
        const GITHUB_API_URL = 'https://api.github.com/repos/bubbls/ugs-singlefile/contents/UGS-Files';
        const RAW_BASE_URL = 'https://raw.githubusercontent.com/bubbls/ugs-singlefile/main/UGS-Files/';
        const FAVICON_URL = 'https://instructure-uploads.s3.amazonaws.com/account_30000000002042/attachments/80746393/favicon-16x16.png';
        const TAB_TITLE = 'Dashboard';

        let files = [];

        function formatGameName(file) {
            let name = file;

            if (name.toLowerCase().startsWith('cl')) {
                name = name.substring(2);
            }

            name = name.replace(/(ifnoaboutblank|noaboutblank|maybeidk|imprettysureitsexactlythesameidk)/gi, '');

            name = name
                .replace(/[_\-]+/g, ' ')
                .replace(/\((.*?)\)/g, ' ')
                .replace(/\[(.*?)\]/g, ' ')
                .replace(/\./g, ' ');

            name = name
                .replace(/([a-z])([A-Z])/g, '$1 $2')
                .replace(/([A-Za-z])(\d)/g, '$1 $2')
                .replace(/(\d)([A-Za-z])/g, '$1 $2');

            name = name.replace(/\s+/g, ' ').trim();
            name = name.replace(/\b(\d+)\s*[vV]\s*(\d+)\b/g, '$1v$2');
            name = name.replace(/\b(2|3)\s*[dD]\b/g, (_, d) => `${d}D`);
            name = name.replace(/\b[vV][sS]\b/g, 'vs');
            name = name.replace(/\b[xX]\s*(\d+)\b/g, (m, n) => `x${n}`);

            const acronyms = new Set([
                'LOL','FIFA','NBA','NFL','NHL','MLB','IO','HD','DX','FX','XR','AR','VR','DS','GBA','GBC','GB','NES','SNES','N64',
                'RPG','FPS','TD','USD','VS','XL','XXL','DX','3D','2D','II','III','IV','VI','VII','VIII','IX','X'
            ]);
            const lowers = new Set(['of','the','and','a','an','in','on','to','for','at','by','from','or']);

            const words = name.split(' ').map((w) => {
                const upper = w.toUpperCase();
                const lower = w.toLowerCase();
                if (acronyms.has(upper)) return upper;
                if (lowers.has(lower)) return lower;
                return lower.charAt(0).toUpperCase() + lower.slice(1);
            });

            if (words.length > 0) {
                const first = words[0];
                words[0] = first.charAt(0).toUpperCase() + first.slice(1);
            }

            name = words.join(' ').replace(/\s+/g, ' ').trim();
            return name;
        }

        async function fetchFileList() {
            const response = await fetch(GITHUB_API_URL);
            if (!response.ok) {
                throw new Error(`GitHub API error: ${response.status}`);
            }
            const data = await response.json();
            
            // Filter for .html files and extract names without extension
            return data
                .filter(item => item.type === 'file' && item.name.endsWith('.html'))
                .map(item => item.name.replace('.html', ''));
        }

        function injectTitleAndFavicon(htmlContent) {
            // Script to override title and favicon
            const injectionScript = `
                <script>
                    (function() {
                        // Set title
                        document.title = '${TAB_TITLE}';
                        
                        // Remove existing favicons
                        const existingIcons = document.querySelectorAll('link[rel="icon"], link[rel="shortcut icon"]');
                        existingIcons.forEach(icon => icon.remove());
                        
                        // Add new favicon
                        const link = document.createElement('link');
                        link.rel = 'icon';
                        link.type = 'image/png';
                        link.href = '${FAVICON_URL}';
                        document.head.appendChild(link);
                        
                        // Also set shortcut icon for compatibility
                        const shortcutLink = document.createElement('link');
                        shortcutLink.rel = 'shortcut icon';
                        shortcutLink.type = 'image/png';
                        shortcutLink.href = '${FAVICON_URL}';
                        document.head.appendChild(shortcutLink);
                        
                        // Override any attempts to change the title
                        const originalTitle = Object.getOwnPropertyDescriptor(Document.prototype, 'title');
                        Object.defineProperty(document, 'title', {
                            get: function() { return '${TAB_TITLE}'; },
                            set: function() { return '${TAB_TITLE}'; }
                        });
                    })();
                <\/script>
            `;
            
            // Inject at the end of body or before closing </html>
            if (htmlContent.includes('</body>')) {
                return htmlContent.replace('</body>', injectionScript + '</body>');
            } else if (htmlContent.includes('</html>')) {
                return htmlContent.replace('</html>', injectionScript + '</html>');
            } else {
                return htmlContent + injectionScript;
            }
        }

        function generateAllSections() {
            const allChars = ['0','1','2','3','4','5','6','7','8','9',
                            'A','B','C','D','E','F','G','H','I','J','K','L','M',
                            'N','O','P','Q','R','S','T','U','V','W','X','Y','Z'];
            
            const filesByChar = {};
            allChars.forEach(char => {
                filesByChar[char] = [];
            });

            files.forEach(file => {
                const lower = file.toLowerCase();
                let firstChar;
                
                if (lower.startsWith('cl')) {
                    const afterCl = lower.substring(2);
                    if (afterCl.length > 0) {
                        firstChar = afterCl[0].toUpperCase();
                    }
                } else {
                    firstChar = lower[0].toUpperCase();
                }
                
                if (firstChar && filesByChar[firstChar]) {
                    filesByChar[firstChar].push(file);
                }
            });

            allChars.forEach(char => {
                filesByChar[char].sort((a, b) => {
                    const nameA = formatGameName(a).toLowerCase();
                    const nameB = formatGameName(b).toLowerCase();
                    return nameA.localeCompare(nameB);
                });
            });

            const container = document.getElementById('sections-container');
            container.innerHTML = '';
            
            allChars.forEach(char => {
                const section = document.createElement('div');
                section.className = 'letter-section';
                section.id = `section-${char}`;
                
                const header = document.createElement('div');
                header.className = 'letter-header';
                header.textContent = char;
                section.appendChild(header);

                if (filesByChar[char].length > 0) {
                    const gamesGrid = document.createElement('div');
                    gamesGrid.className = 'games-grid';

                    filesByChar[char].forEach(file => {
                        const card = document.createElement('div');
                        card.className = 'game-card';
                        card.setAttribute('data-game-name', formatGameName(file).toLowerCase());
                        card.setAttribute('data-file-name', file);
                        
                        const title = document.createElement('div');
                        title.className = 'game-title';
                        title.textContent = formatGameName(file);
                        
                        card.appendChild(title);
                        card.onclick = () => {
                            fetch(`${RAW_BASE_URL}${encodeURIComponent(file)}.html?t=${Date.now()}`)
                                .then(response => {
                                    if (!response.ok) {
                                        throw new Error('Game not found');
                                    }
                                    return response.text();
                                })
                                .then(text => {
                                    // Inject title and favicon override
                                    const modifiedContent = injectTitleAndFavicon(text);
                                    
                                    const newWin = window.open("about:blank", "_blank");
                                    if (newWin) {
                                        newWin.document.open();
                                        newWin.document.write(modifiedContent);
                                        newWin.document.close();
                                    }
                                })
                                .catch(err => {
                                    alert('Failed to load game: ' + err.message);
                                });
                        };
                        
                        gamesGrid.appendChild(card);
                    });

                    section.appendChild(gamesGrid);
                } else {
                    const emptyMsg = document.createElement('div');
                    emptyMsg.className = 'empty-section';
                    emptyMsg.textContent = 'No games available';
                    section.appendChild(emptyMsg);
                }

                container.appendChild(section);
            });
        }

        function setupSearch() {
            const searchBox = document.getElementById('searchBox');
            const noResults = document.getElementById('no-results');

            searchBox.disabled = false;

            searchBox.addEventListener('input', (e) => {
                const searchTerm = e.target.value.toLowerCase().trim();
                
                if (searchTerm === '') {
                    document.querySelectorAll('.letter-section').forEach(section => {
                        section.classList.remove('hidden');
                    });
                    document.querySelectorAll('.game-card').forEach(card => {
                        card.style.display = '';
                    });
                    noResults.style.display = 'none';
                } else {
                    let hasResults = false;
                    
                    document.querySelectorAll('.letter-section').forEach(section => {
                        section.classList.add('hidden');
                    });
                    
                    document.querySelectorAll('.game-card').forEach(card => {
                        const gameName = card.getAttribute('data-game-name');
                        const fileName = card.getAttribute('data-file-name').toLowerCase();
                        
                        if (gameName.includes(searchTerm) || fileName.includes(searchTerm)) {
                            card.style.display = '';
                            card.closest('.letter-section').classList.remove('hidden');
                            hasResults = true;
                        } else {
                            card.style.display = 'none';
                        }
                    });
                    
                    noResults.style.display = hasResults ? 'none' : 'block';
                }
            });a
        }

        async function init() {
            const loadingEl = document.getElementById('loading');
            const errorEl = document.getElementById('error');

            try {
                files = await fetchFileList();
                loadingEl.style.display = 'none';
                generateAllSections();
                setupSearch();
            } catch (err) {
                loadingEl.style.display = 'none';
                errorEl.textContent = `Failed to load games: ${err.message}. Please refresh the page to try again.`;
                errorEl.style.display = 'block';
                console.error('Error loading file list:', err);
            }
        }

        window.addEventListener('DOMContentLoaded', init);
    </script>
</body>
</html>
